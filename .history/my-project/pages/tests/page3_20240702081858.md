```sql database1_tests
WITH pie_data AS (
    SELECT 
        name, 
        AVG(duration) AS avg_duration,
        100 * (1 - (miss / stmts)) AS coverage_percentage
    FROM (
        VALUES
            ('test_classification.py', 499, 13, 121-126, 353-358, 586),
            ('test_get_docs.py', 42, 1, 54),
            ('test_interact.py', 383, 36, '546-561, 775-788, 791-795, 798-800, 803-812, 815-828, 1014-1027, 1074-1087, 1090-1103, 1108-1117, 1122-1135, 1207'),
            ('test_message.py', 23, 1, 59),
            ('test_rate_response.py', 32, 1, 63)
    ) AS t (name, stmts, miss, missing)
    JOIN test_database.test_data1 ON t.name = test_data1.file
    WHERE module = 'test_classification'
    AND name IN (
        'test_classification_arabic_text',
        'test_classification_code_snippet',
        'test_classification_combination_characters',
        'test_classification_combined_unicode_text',
        'test_classification_cyrillic_text',
        'test_classification_default'
    )
    GROUP BY name, stmts, miss
)
SELECT name, avg_duration, coverage_percentage
FROM pie_data;

```

```sql database1_tests
WITH coverage_data AS (
    SELECT 
        name, 
        stmts, 
        miss,
        100 * (1 - (miss / stmts)) AS coverage_percentage
    FROM (
        VALUES
            ('test_classification.py', 499, 13),
            ('test_get_docs.py', 42, 1),
            ('test_interact.py', 383, 36),
            ('test_message.py', 23, 1),
            ('test_rate_response.py', 32, 1)
    ) AS t (name, stmts, miss)
),
duration_data AS (
    SELECT 
        file AS name, 
        AVG(duration) AS avg_duration
    FROM test_database.test_data1
    GROUP BY file
)
SELECT 
    c.name, 
    d.avg_duration, 
    c.coverage_percentage
FROM coverage_data c
JOIN duration_data d ON c.name = d.name;
```

<ECharts config={{
    tooltip: {
        formatter: '{b}: {c} ({d}%)'
    },
    series: [
        {
            name: 'Test Coverage and Duration',
            type: 'pie',
            data: [
                { name: 'test_classification.py (97%)', value: 7.61 },
                { name: 'test_get_docs.py (98%)', value: 3.43 },
                { name: 'test_interact.py (91%)', value: 2.95 },
                { name: 'test_message.py (96%)', value: 2.76 },
                { name: 'test_rate_response.py (97%)', value: 3.70 },
            ],
        },
    ],
}} />


