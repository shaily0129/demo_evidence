```sql table8
WITH coverage_data AS (
    SELECT 
        name, 
        stmts, 
        miss,
        100 * (1 - (miss / stmts)) AS coverage_percentage
    FROM (
        VALUES
            ('test_classification.py', 499, 13),
            ('test_get_docs.py', 42, 1),
            ('test_interact.py', 383, 36),
            ('test_message.py', 23, 1),
            ('test_rate_response.py', 32, 1)
    ) AS t (name, stmts, miss)
),
duration_data AS (
    SELECT 
        file AS name, 
        AVG(duration) AS avg_duration
    FROM test_database.test_data1
    GROUP BY file
)
SELECT 
    c.name, 
    d.avg_duration, 
    c.coverage_percentage
FROM coverage_data c
JOIN duration_data d ON c.name = d.name;
```

```sql table9
SELECT 
    name,
    stmts,
    miss,
    cover,
    missing
FROM 
    test_database.coverage_data
```

```sql table10
WITH treemap_data AS (
    SELECT 
        name,
        cover AS value
    FROM 
        test_database.coverage_data
)
SELECT 
    name,
    value
FROM 
    treemap_data;
```



<ECharts config={{
    tooltip: {
        formatter: '{b}: {c} ({d}%)'
    },
    series: [
        {
            name: 'Test Coverage and Duration',
            type: 'pie',
            data: [
                { name: 'test_classification.py (97%)', value: 7.61 },
                { name: 'test_get_docs.py (98%)', value: 3.43 },
                { name: 'test_interact.py (91%)', value: 2.95 },
                { name: 'test_message.py (96%)', value: 2.76 },
                { name: 'test_rate_response.py (97%)', value: 3.70 },
            ],
        },
    ],
}} />

<ECharts
    config={{
        title: {
            text: 'Coverage Treemap',
            left: 'center'
        },
        tooltip: {
            formatter: '{b}: {c}%'
        },
        series: [
            {
                type: 'treemap',
                visibleMin: 300,
                label: {
                    show: true,
                    formatter: '{b}: {c}%'
                },
                itemStyle: {
                    borderColor: '#fff'
                },
                roam: false,
                nodeClick: false,
                data: [
                    { name: 'test_classification.py', value: 97 },
                    { name: 'test_get_docs.py', value: 98 },
                    { name: 'test_interact.py', value: 91 },
                    { name: 'test_message.py', value: 96 },
                    { name: 'test_rate_response.py', value: 97 }
                ],
                breadcrumb: {
                    show: false
                }
            }
        ]
    }}
/>


<ECharts
    config={{
        tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        series: [
            {
                name: 'Coverage',
                type: 'pie',
                radius: ['40%', '70%'],
                data: [
                    { value: 499 - 13, name: 'test_classification.py' },
                    { value: 42 - 1, name: 'test_get_docs.py' },
                    { value: 383 - 36, name: 'test_interact.py' },
                    { value: 23 - 1, name: 'test_message.py' },
                    { value: 32 - 1, name: 'test_rate_response.py' }
                ],
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    }}
/>

<DimensionGrid 
    data={table9} 
    name="selected_dimensions"
    dimensions={[
        { name: 'Name', dataKey: 'name' },
        { name: 'Statements', dataKey: 'stmts' },
        { name: 'Miss', dataKey: 'miss' },
        { name: 'Cover', dataKey: 'cover' },
        { name: 'Missing', dataKey: 'missing' }
    ]}
    config={{
        dimensionLabelRotation: -45,
        cellTooltip: true,
        headerHighlight: true
    }}
/>
